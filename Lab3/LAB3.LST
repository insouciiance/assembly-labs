Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 1
lab3.asm



      1	0000			     STSEG SEGMENT PARA	STACK 'Stack'
      2	0000  40*(????)			 DW 64 DUP (?)
      3	0080			     STSEG ENDS
      4
      5	0000			     DSEG SEGMENT PARA 'Data'
      6	      =000D			 CR EQU	0DH
      7	      =000A			 LF EQU	0AH
      8	      =-8000			 MIN EQU -32768
      9	      =7FFF			 MAX EQU 32767
     10
     11	0000				 XPAR LABEL BYTE
     12	0000  14			 XMAXLEN DB 20
     13	0001  ??			 XLEN DB ?
     14	0002  14*(20) 24		 XFLD DB 20 DUP(' '), '$'
     15
     16	0017				 YPAR LABEL BYTE
     17	0017  14			 YMAXLEN DB 20
     18	0018  ??			 YLEN DB ?
     19	0019  14*(20) 24		 YFLD DB 20 DUP(' '), '$'
     20
     21	002E  45 6E 74 65 72 20	78+	 PROMPTX DB 'Enter x:',	'$'
     22	      3A 24
     23	0037  45 6E 74 65 72 20	79+	 PROMPTY DB 'Enter y:',	'$'
     24	      3A 24
     25	0040  45 6E 74 65 72 65	64+	 ERRORMSG DB 'Entered number was invalid.', '$'
     26	      20 6E 75 6D 62 65	72+
     27	      20 77 61 73 20 69	6E+
     28	      76 61 6C 69 64 2E	24
     29
     30	005C  ????			 NUMX DW ?
     31	005E  ????			 NUMY DW ?
     32	0060  ????			 NUMH DW ?
     33	0062  ????			 NUML DW ?
     34	0064  0001			 POSITION DW 1
     35	0066  000A			 NUMRADIX DW 10
     36
     37	0068  0000			 FUNC1AUX DW 0
     38	006A  0000			 FUNC2DIVISOR DW 0
     39	006C  0002			 FUNC3MULTIPLIER DW 2
     40
     41	006E  0000			 CAST_DIVISOR DW 0
     42	0070  05			 DECIMAL_PRECISION DB 5
     43
     44	0071  ??			 ISERROR DB ?
     45	0072			     DSEG ENDS
     46
     47	0000			     CSEG SEGMENT PARA 'Code'
     48	0000				 BEGIN PROC FAR
     49					 ASSUME	CS:CSEG, DS:DSEG, SS:STSEG
     50	0000  1E			     PUSH DS
     51	0001  B8 0000			     MOV AX, 0
     52	0004  50			     PUSH AX
     53	0005  B8 0000s			     MOV AX, DSEG
     54	0008  8E D8			     MOV DS, AX
     55
     56	000A				     INPUT_X:
     57	000A  C6 06 0071r 00			 MOV ISERROR, 0
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 2
lab3.asm



     58	000F  E8 005F				 CALL INPUTX
     59	0012  80 3E 0071r 00			 CMP ISERROR, 0
     60	0017  7F F1				 JG INPUT_X
     61	0019  E8 007F				 CALL CASTX
     62	001C  80 3E 0071r 00			 CMP ISERROR, 0
     63	0021  7F E7				 JG INPUT_X
     64
     65	0023  83 3E 005Cr FF			 CMP NUMX, -01H
     66	0028  7F 06				 JG CHECKFUNC2
     67	002A  E8 019A				 CALL FUNC3
     68	002D  EB 3A 90				 JMP RETURN_INT
     69	0030					 CHECKFUNC2:
     70	0030  83 3E 005Cr 01			     CMP NUMX, 01H
     71	0035  7F 06				     JG	CHECKFUNC1
     72	0037  E8 0168				     CALL FUNC2
     73	003A  EB 31 90				     JMP RETURN_DECIMAL
     74	003D					     CHECKFUNC1:
     75	003D  83 3E 005Cr 03				 CMP NUMX, 03H
     76	0042  7F 06					 JG INPUT_Y
     77	0044  E8 0132					 CALL FUNC1
     78	0047  EB 24 90					 JMP RETURN_DECIMAL
     79	004A						 INPUT_Y:
     80	004A  C6 06 0071r 00				     MOV ISERROR, 0
     81	004F  E8 0034					     CALL INPUTY
     82	0052  80 3E 0071r 00				     CMP ISERROR, 0
     83	0057  7F F1					     JG	INPUT_Y
     84	0059  E8 00AE					     CALL CASTY
     85	005C  80 3E 0071r 00				     CMP ISERROR, 0
     86	0061  7F E7					     JG	INPUT_Y
     87	0063  E8 0170					     CALL FUNC4
     88	0066  EB 01 90					     JMP RETURN_INT
     89	0069					 RETURN_INT:
     90	0069  E8 01A2				     CALL CASTRESULT
     91	006C  CB				     RET
     92	006D					 RETURN_DECIMAL:
     93	006D  E8 01DC				     CALL CASTDECIMAL
     94	0070  CB				     RET
     95	0071				 BEGIN ENDP
     96
     97	0071				 INPUTX	PROC NEAR
     98	0071  B4 09			     MOV AH, 09H
     99	0073  BA 002Er			     LEA DX, PROMPTX
    100	0076  CD 21			     INT 21H
    101
    102	0078  E8 023B			     CALL NEWLINE
    103
    104	007B  B4 0A			     MOV AH, 0AH
    105	007D  BA 0000r			     LEA DX, XPAR
    106	0080  CD 21			     INT 021H
    107
    108	0082  E8 0231			     CALL NEWLINE
    109	0085  C3			     RET
    110	0086				 INPUTX	ENDP
    111
    112	0086				 INPUTY	PROC NEAR
    113	0086  B4 09			     MOV AH, 09H
    114	0088  BA 0037r			     LEA DX, PROMPTY
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 3
lab3.asm



    115	008B  CD 21			     INT 21H
    116
    117	008D  E8 0226			     CALL NEWLINE
    118
    119	0090  B4 0A			     MOV AH, 0AH
    120	0092  BA 0017r			     LEA DX, YPAR
    121	0095  CD 21			     INT 021H
    122
    123	0097  E8 021C			     CALL NEWLINE
    124	009A  C3			     RET
    125	009B				 INPUTY	ENDP
    126
    127	009B				 CASTX PROC NEAR
    128	009B  C7 06 005Cr 0000		     MOV NUMX, 0
    129	00A1  C7 06 0064r 0001		     MOV POSITION, 01H
    130	00A7  B5 00			     MOV CH, 0
    131	00A9  8A 0E 0001r		     MOV CL, XLEN
    132	00AD  8B D9			     MOV BX, CX
    133	00AF  4B			     DEC BX
    134	00B0  BE 0002r			     LEA SI, XFLD
    135	00B3  8B 04			     MOV AX, [SI]
    136	00B5  3C 2D			     CMP AL, '-'
    137	00B7  75 01			     JNE PROCESS_DIGITX
    138	00B9  49			     DEC CX
    139	00BA				     PROCESS_DIGITX:
    140	00BA  B4 00				 MOV AH, 0
    141	00BC  8A 00				 MOV AL, [SI + BX]
    142	00BE  3C 30				 CMP AL, 030H
    143	00C0  7C 3F				 JL RETURNERR_CASTX
    144	00C2  3C 39				 CMP AL, 039H
    145	00C4  7F 3B				 JG RETURNERR_CASTX
    146	00C6  2C 30				 SUB AL, 030H
    147	00C8  F7 2E 0064r			 IMUL POSITION
    148	00CC  70 33				 JO RETURNERR_CASTX
    149	00CE  01 06 005Cr			 ADD NUMX, AX
    150	00D2  71 0E				 JNO NEXT_CASTX
    151	00D4  81 3E 005Cr 8000			 CMP NUMX, MIN
    152	00DA  75 25				 JNE RETURNERR_CASTX
    153	00DC  8B 04				 MOV AX, [SI]
    154	00DE  3C 2D				 CMP AL, '-'
    155	00E0  75 1F				 JNE RETURNERR_CASTX
    156	00E2					 NEXT_CASTX:
    157	00E2  4B				     DEC BX
    158	00E3  83 F9 01				     CMP CX, 01H
    159	00E6  74 0E				     JE	PRERETURN_CASTX
    160	00E8  A1 0064r				     MOV AX, POSITION
    161	00EB  F7 2E 0066r			     IMUL NUMRADIX
    162	00EF  70 10				     JO	RETURNERR_CASTX
    163	00F1  A3 0064r				     MOV POSITION, AX
    164	00F4  E2 C4				     LOOP PROCESS_DIGITX
    165	00F6				     PRERETURN_CASTX:
    166	00F6  8B 04				 MOV AX, [SI]
    167	00F8  3C 2D				 CMP AL, '-'
    168	00FA  75 04				 JNE RETURN_CASTX
    169	00FC  F7 1E 005Cr			 NEG NUMX
    170	0100				     RETURN_CASTX:
    171	0100  C3				 RET
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 4
lab3.asm



    172	0101				     RETURNERR_CASTX:
    173	0101  E8 01A7				 CALL PRINTERR
    174	0104  C6 06 0071r 01			 MOV ISERROR, 01H
    175	0109  C3				 RET
    176	010A				 CASTX ENDP
    177
    178	010A				 CASTY PROC NEAR
    179	010A  C7 06 005Er 0000		     MOV NUMY, 0
    180	0110  C7 06 0064r 0001		     MOV POSITION, 01H
    181	0116  B5 00			     MOV CH, 0
    182	0118  8A 0E 0018r		     MOV CL, YLEN
    183	011C  8B D9			     MOV BX, CX
    184	011E  4B			     DEC BX
    185	011F  BE 0019r			     LEA SI, YFLD
    186	0122  8B 04			     MOV AX, [SI]
    187	0124  3C 2D			     CMP AL, '-'
    188	0126  75 01			     JNE PROCESS_DIGITY
    189	0128  49			     DEC CX
    190	0129				     PROCESS_DIGITY:
    191	0129  B4 00				 MOV AH, 0
    192	012B  8A 00				 MOV AL, [SI + BX]
    193	012D  3C 30				 CMP AL, 030H
    194	012F  7C 3F				 JL RETURNERR_CASTY
    195	0131  3C 39				 CMP AL, 039H
    196	0133  7F 3B				 JG RETURNERR_CASTY
    197	0135  2C 30				 SUB AL, 030H
    198	0137  F7 2E 0064r			 IMUL POSITION
    199	013B  70 33				 JO RETURNERR_CASTY
    200	013D  01 06 005Er			 ADD NUMY, AX
    201	0141  71 0E				 JNO NEXT_CASTY
    202	0143  81 3E 005Er 8000			 CMP NUMY, MIN
    203	0149  75 25				 JNE RETURNERR_CASTY
    204	014B  8B 04				 MOV AX, [SI]
    205	014D  3C 2D				 CMP AL, '-'
    206	014F  75 1F				 JNE RETURNERR_CASTY
    207	0151					 NEXT_CASTY:
    208	0151  4B				     DEC BX
    209	0152  83 F9 01				     CMP CX, 01H
    210	0155  74 0E				     JE	PRERETURN_CASTY
    211	0157  A1 0064r				     MOV AX, POSITION
    212	015A  F7 2E 0066r			     IMUL NUMRADIX
    213	015E  70 10				     JO	RETURNERR_CASTY
    214	0160  A3 0064r				     MOV POSITION, AX
    215	0163  E2 C4				     LOOP PROCESS_DIGITY
    216	0165				     PRERETURN_CASTY:
    217	0165  8B 04				 MOV AX, [SI]
    218	0167  3C 2D				 CMP AL, '-'
    219	0169  75 04				 JNE RETURN_CASTY
    220	016B  F7 1E 005Er			 NEG NUMY
    221	016F				     RETURN_CASTY:
    222	016F  C3				 RET
    223	0170				     RETURNERR_CASTY:
    224	0170  E8 0138				 CALL PRINTERR
    225	0173  C6 06 0071r 01			 MOV ISERROR, 01H
    226	0178  C3				 RET
    227	0179				 CASTY ENDP
    228
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 5
lab3.asm



    229	0179				 FUNC1 PROC NEAR ; result = 35 / X + X^3
    230	0179  B8 0023			     MOV AX, 35
    231	017C  F7 3E 005Cr		     IDIV NUMX
    232	0180  8B 1E 005Cr		     MOV BX, NUMX
    233	0184  89 1E 006Er		     MOV CAST_DIVISOR, BX
    234	0188  89 16 0060r		     MOV NUMH, DX
    235	018C  A3 0068r			     MOV FUNC1AUX, AX
    236	018F  A1 005Cr			     MOV AX, NUMX
    237	0192  F7 2E 005Cr		     IMUL NUMX
    238	0196  F7 2E 005Cr		     IMUL NUMX
    239	019A  03 06 0068r		     ADD AX, FUNC1AUX
    240	019E  A3 0062r			     MOV NUML, AX
    241	01A1  C3			     RET
    242	01A2				 FUNC1 ENDP
    243
    244	01A2				 FUNC2 PROC NEAR ; result = X /	(X^2 + 1)
    245	01A2  A1 005Cr			     MOV AX, NUMX
    246	01A5  F7 2E 005Cr		     IMUL NUMX
    247	01A9  40			     INC AX
    248	01AA  A3 006Ar			     MOV FUNC2DIVISOR, AX
    249	01AD  8B 1E 006Ar		     MOV BX, FUNC2DIVISOR
    250	01B1  89 1E 006Er		     MOV CAST_DIVISOR, BX
    251	01B5  A1 005Cr			     MOV AX, NUMX
    252	01B8  BA 0000			     MOV DX, 0
    253	01BB  F7 3E 006Ar		     IDIV FUNC2DIVISOR
    254	01BF  A3 0062r			     MOV NUML, AX
    255	01C2  89 16 0060r		     MOV NUMH, DX
    256	01C6  C3			     RET
    257	01C7				 FUNC2 ENDP
    258
    259	01C7				 FUNC3 PROC NEAR ; result = 2X
    260	01C7  A1 005Cr			     MOV AX, NUMX
    261	01CA  F7 2E 006Cr		     IMUL FUNC3MULTIPLIER
    262	01CE  89 16 0060r		     MOV NUMH, DX
    263	01D2  A3 0062r			     MOV NUML, AX
    264	01D5  C3			     RET
    265	01D6				 FUNC3 ENDP
    266
    267	01D6				 FUNC4 PROC NEAR ; result = X +	Y
    268	01D6  A1 005Cr			     MOV AX, NUMX
    269	01D9  83 3E 005Er 00		     CMP NUMY, 0
    270	01DE  7D 1B			     JGE ADDY
    271	01E0  F7 1E 005Er		     NEG NUMY
    272	01E4  2B 06 005Er		     SUB AX, NUMY
    273	01E8  A3 0062r			     MOV NUML, AX
    274	01EB  C7 06 0060r 0000		     MOV NUMH, 0
    275	01F1  79 1A			     JNS RETURNFUNC4
    276	01F3  83 1E 0060r 00		     SBB NUMH, 0
    277	01F8  EB 13 90			     JMP RETURNFUNC4
    278	01FB				     ADDY:
    279	01FB  03 06 005Er			 ADD AX, NUMY
    280	01FF  A3 0062r				 MOV NUML, AX
    281	0202  C7 06 0060r 0000			 MOV NUMH, 0
    282	0208  83 16 0060r 00			 ADC NUMH, 0
    283	020D					 RETURNFUNC4:
    284	020D  C3				 RET
    285	020E				 FUNC4 ENDP
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 6
lab3.asm



    286
    287	020E				 CASTRESULT PROC NEAR
    288	020E  83 3E 0060r 00		     CMP NUMH, 0
    289	0213  7D 16			     JGE CAST_1
    290	0215  B0 2D			     MOV AL, '-'
    291	0217  CD 29			     INT 29H
    292	0219  F7 16 0060r		     NOT NUMH
    293	021D  F7 16 0062r		     NOT NUML
    294	0221  83 06 0062r 01		     ADD NUML, 01H
    295	0226  83 16 0060r 00		     ADC NUMH, 0
    296	022B				     CAST_1:
    297	022B  B9 0000				 MOV CX, 0
    298	022E  BB 000A				 MOV BX, 0AH
    299	0231  8B 16 0060r			 MOV DX, NUMH
    300	0235  A1 0062r				 MOV AX, NUML
    301	0238				     CAST_2:
    302	0238  F7 FB				 IDIV BX
    303	023A  80 CA 30				 OR DL,	030H
    304	023D  52				 PUSH DX
    305	023E  41				 INC CX
    306	023F  BA 0000				 MOV DX, 0
    307	0242  85 C0				 TEST AX, AX
    308	0244  75 F2				 JNZ CAST_2
    309	0246				     CAST_3:
    310	0246  58				 POP AX
    311	0247  CD 29				 INT 029H
    312	0249  E2 FB				 LOOP CAST_3
    313	024B  C3			     RET
    314	024C				 CASTRESULT ENDP
    315
    316	024C				 CASTDECIMAL PROC NEAR
    317	024C  83 3E 0062r 00		     CMP NUML, 0
    318	0251  7D 08			     JGE CAST_INT1
    319	0253  B0 2D			     MOV AL, '-'
    320	0255  CD 29			     INT 29H
    321	0257  F7 1E 0062r		     NEG NUML
    322	025B				     CAST_INT1:
    323	025B  B9 0000				 MOV CX, 0
    324	025E  BB 000A				 MOV BX, 0AH
    325	0261  A1 0062r				 MOV AX, NUML
    326	0264  BA 0000				 MOV DX, 0
    327	0267				     CAST_INT2:
    328	0267  F7 FB				 IDIV BX
    329	0269  80 CA 30				 OR DL,	030H
    330	026C  52				 PUSH DX
    331	026D  41				 INC CX
    332	026E  BA 0000				 MOV DX, 0
    333	0271  85 C0				 TEST AX, AX
    334	0273  75 F2				 JNZ CAST_INT2
    335	0275				     CAST_INT3:
    336	0275  58				 POP AX
    337	0276  CD 29				 INT 029H
    338	0278  E2 FB				 LOOP CAST_INT3
    339
    340	027A  83 3E 0060r 00		     CMP NUMH, 0
    341	027F  74 29			     JE	DECIMAL_RETURN
    342
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 7
lab3.asm



    343	0281  B8 002E			     MOV AX, 02EH ; dot(.)
    344	0284  CD 29			     INT 029H
    345
    346	0286  A1 0060r			     MOV AX, NUMH
    347	0289				     CAST_DECIMAL1:
    348	0289  F7 2E 0066r			 IMUL NUMRADIX
    349	028D  F7 3E 006Er			 IDIV CAST_DIVISOR
    350	0291  0D 0030				 OR AX,	030H
    351	0294  CD 29				 INT 029H
    352	0296  8B C2				 MOV AX, DX
    353	0298  FE 0E 0070r			 DEC DECIMAL_PRECISION
    354	029C  80 3E 0070r 00			 CMP DECIMAL_PRECISION,	0
    355	02A1  7E 07				 JLE DECIMAL_RETURN
    356	02A3  3D 0000				 CMP AX, 0
    357	02A6  74 02				 JE DECIMAL_RETURN
    358	02A8  EB DF				 JMP CAST_DECIMAL1
    359	02AA				     DECIMAL_RETURN:
    360	02AA  C3				 RET
    361	02AB				 CASTDECIMAL ENDP
    362
    363	02AB				 PRINTERR PROC NEAR
    364	02AB  B4 09			     MOV AH, 09H
    365	02AD  BA 0040r			     LEA DX, ERRORMSG
    366	02B0  CD 21			     INT 021H
    367	02B2  E8 0001			     CALL NEWLINE
    368	02B5  C3			     RET
    369	02B6				 PRINTERR ENDP
    370
    371	02B6				 NEWLINE PROC NEAR
    372	02B6  B2 0D			     MOV DL, CR
    373	02B8  B4 02			     MOV AH, 02H
    374	02BA  CD 21			     INT 21H
    375	02BC  B2 0A			     MOV DL, LF
    376	02BE  B4 02			     MOV AH, 02H
    377	02C0  CD 21			     INT 21H
    378	02C2  C3			     RET
    379	02C3				 NEWLINE ENDP
    380	02C3			     CSEG ENDS
    381				     END BEGIN
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 8
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "19/10/21"
??FILENAME			  Text	 "lab3	  "
??TIME				  Text	 "19:03:10"
??VERSION			  Number 0400
@CPU				  Text	 0101H
@CURSEG				  Text	 CSEG
@FILENAME			  Text	 LAB3
@WORDSIZE			  Text	 2
ADDY				  Near	 CSEG:01FB
BEGIN				  Far	 CSEG:0000
CASTDECIMAL			  Near	 CSEG:024C
CASTRESULT			  Near	 CSEG:020E
CASTX				  Near	 CSEG:009B
CASTY				  Near	 CSEG:010A
CAST_1				  Near	 CSEG:022B
CAST_2				  Near	 CSEG:0238
CAST_3				  Near	 CSEG:0246
CAST_DECIMAL1			  Near	 CSEG:0289
CAST_DIVISOR			  Word	 DSEG:006E
CAST_INT1			  Near	 CSEG:025B
CAST_INT2			  Near	 CSEG:0267
CAST_INT3			  Near	 CSEG:0275
CHECKFUNC1			  Near	 CSEG:003D
CHECKFUNC2			  Near	 CSEG:0030
CR				  Number 000D
DECIMAL_PRECISION		  Byte	 DSEG:0070
DECIMAL_RETURN			  Near	 CSEG:02AA
ERRORMSG			  Byte	 DSEG:0040
FUNC1				  Near	 CSEG:0179
FUNC1AUX			  Word	 DSEG:0068
FUNC2				  Near	 CSEG:01A2
FUNC2DIVISOR			  Word	 DSEG:006A
FUNC3				  Near	 CSEG:01C7
FUNC3MULTIPLIER			  Word	 DSEG:006C
FUNC4				  Near	 CSEG:01D6
INPUTX				  Near	 CSEG:0071
INPUTY				  Near	 CSEG:0086
INPUT_X				  Near	 CSEG:000A
INPUT_Y				  Near	 CSEG:004A
ISERROR				  Byte	 DSEG:0071
LF				  Number 000A
MAX				  Number 7FFF
MIN				  Number -8000
NEWLINE				  Near	 CSEG:02B6
NEXT_CASTX			  Near	 CSEG:00E2
NEXT_CASTY			  Near	 CSEG:0151
NUMH				  Word	 DSEG:0060
NUML				  Word	 DSEG:0062
NUMRADIX			  Word	 DSEG:0066
NUMX				  Word	 DSEG:005C
NUMY				  Word	 DSEG:005E
POSITION			  Word	 DSEG:0064
PRERETURN_CASTX			  Near	 CSEG:00F6
PRERETURN_CASTY			  Near	 CSEG:0165
Turbo Assembler	 Version 4.0	    19/10/21 19:03:10	    Page 9
Symbol Table



PRINTERR			  Near	 CSEG:02AB
PROCESS_DIGITX			  Near	 CSEG:00BA
PROCESS_DIGITY			  Near	 CSEG:0129
PROMPTX				  Byte	 DSEG:002E
PROMPTY				  Byte	 DSEG:0037
RETURNERR_CASTX			  Near	 CSEG:0101
RETURNERR_CASTY			  Near	 CSEG:0170
RETURNFUNC4			  Near	 CSEG:020D
RETURN_CASTX			  Near	 CSEG:0100
RETURN_CASTY			  Near	 CSEG:016F
RETURN_DECIMAL			  Near	 CSEG:006D
RETURN_INT			  Near	 CSEG:0069
XFLD				  Byte	 DSEG:0002
XLEN				  Byte	 DSEG:0001
XMAXLEN				  Byte	 DSEG:0000
XPAR				  Byte	 DSEG:0000
YFLD				  Byte	 DSEG:0019
YLEN				  Byte	 DSEG:0018
YMAXLEN				  Byte	 DSEG:0017
YPAR				  Byte	 DSEG:0017

Groups & Segments		  Bit Size Align  Combine Class

CSEG				  16  02C3 Para	  none	  CODE
DSEG				  16  0072 Para	  none	  DATA
STSEG				  16  0080 Para	  Stack	  STACK
